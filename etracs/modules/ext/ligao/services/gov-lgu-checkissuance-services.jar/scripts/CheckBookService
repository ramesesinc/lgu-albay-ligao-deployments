import com.rameses.common.*
import com.rameses.annotations.*
import com.rameses.services.extended.*

public class CheckBookService
{
	@DataContext(value="checkbook",adapter="checkissuance")
	def em_checkbook

	@ProxyMethod
	public def approve(entity){
		def old = em_checkbook.find([objid:entity.objid]).first()
		if (!old) 
			throw new Exception('Record does not exist or deleted.')

		if (old.state !='DRAFT')
			throw new Exception('Record is no longer in draft mode.')

		entity.state= 'APPROVED'
		em_checkbook.find([objid:entity.objid]).update([state:entity.state])
		return entity
	}

}